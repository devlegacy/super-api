-- MySQL Script generated by MySQL Workbench
-- mi√© 14 nov 2018 05:19:14 EST
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema super_api
-- -----------------------------------------------------
-- Super api - Nodejs API
-- Database
DROP SCHEMA IF EXISTS `super_api` ;

-- -----------------------------------------------------
-- Schema super_api
--
-- Super api - Nodejs API
-- Database
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `super_api` DEFAULT CHARACTER SET utf8mb4 ;
USE `super_api` ;

-- -----------------------------------------------------
-- Table `super_api`.`permissions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `super_api`.`permissions` ;

CREATE TABLE IF NOT EXISTS `super_api`.`permissions` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `displayName` VARCHAR(45) NOT NULL,
  `description` VARCHAR(45) NOT NULL,
  `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
COMMENT = 'All permisions';


-- -----------------------------------------------------
-- Table `super_api`.`roles`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `super_api`.`roles` ;

CREATE TABLE IF NOT EXISTS `super_api`.`roles` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `displayName` VARCHAR(45) NOT NULL,
  `description` VARCHAR(45) NOT NULL,
  `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
COMMENT = 'All roles';


-- -----------------------------------------------------
-- Table `super_api`.`rolePermissions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `super_api`.`rolePermissions` ;

CREATE TABLE IF NOT EXISTS `super_api`.`rolePermissions` (
  `roleId` INT UNSIGNED NOT NULL,
  `permissionId` INT UNSIGNED NOT NULL,
  INDEX `fk_rolePermissions_roles_idx` (`roleId` ASC, `permissionId` ASC),
  CONSTRAINT `fk_rolePermissions_roles`
    FOREIGN KEY (`roleId` , `permissionId`)
    REFERENCES `super_api`.`roles` (`id` , `id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_rolePermissions_permissions`
    FOREIGN KEY ()
    REFERENCES `super_api`.`permissions` ()
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `super_api`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `super_api`.`users` ;

CREATE TABLE IF NOT EXISTS `super_api`.`users` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(45) NOT NULL,
  `email` VARCHAR(65) NOT NULL,
  `password` VARCHAR(120) NOT NULL,
  `confirmed` TINYINT(1) NOT NULL,
  `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
COMMENT = 'Users in DB';


-- -----------------------------------------------------
-- Table `super_api`.`userRoles`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `super_api`.`userRoles` ;

CREATE TABLE IF NOT EXISTS `super_api`.`userRoles` (
  `userId` INT UNSIGNED NOT NULL,
  `roleId` INT UNSIGNED NOT NULL,
  INDEX `fk_userRoles_users_idx` (`userId` ASC),
  INDEX `fk_userRoles_roles_idx` (`roleId` ASC),
  CONSTRAINT `fk_userRoles_users`
    FOREIGN KEY (`userId`)
    REFERENCES `super_api`.`users` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_userRoles_roles`
    FOREIGN KEY (`roleId`)
    REFERENCES `super_api`.`roles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `super_api`.`permissions`
-- -----------------------------------------------------
START TRANSACTION;
USE `super_api`;
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (1, 'assign-roles-to-user', 'Assign roles to user', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (2, 'remove-roles-from-user', 'Remove roles from user', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (3, 'list-users', 'List users', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (4, 'create-users', 'Create users', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (5, 'read-users', 'Read users', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (6, 'update-users', 'Update users', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (7, 'delete-users', 'Delete users', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (8, 'assign-permissions-to-role', 'Assign permissions to role', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (9, 'remove-permissions-from-role', 'Remove permissions from role', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (10, 'list-roles', 'List roles', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (11, 'create-roles', 'Create roles', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (12, 'read-roles', 'Read roles', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (13, 'update-roles', 'Update roles', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (14, 'delete-roles', 'Delete roles', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (15, 'list-permissions', 'List permissions', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (16, 'create-permissions', 'Create permissions', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (17, 'read-permissions', 'Read permissions', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (18, 'update-permissions', 'Update permissions', 'N/A', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`permissions` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (19, 'delete-permissions', 'Delete permissions', 'N/A', DEFAULT, DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `super_api`.`roles`
-- -----------------------------------------------------
START TRANSACTION;
USE `super_api`;
INSERT INTO `super_api`.`roles` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (1, 'admin', 'The Administrator Role', 'Somebody with access to the API administration features and all other features.', DEFAULT, DEFAULT);
INSERT INTO `super_api`.`roles` (`id`, `name`, `displayName`, `description`, `createdAt`, `updatedAt`) VALUES (2, 'user', 'The User Role', 'Somebody who can only manage their profile.', DEFAULT, DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `super_api`.`rolePermissions`
-- -----------------------------------------------------
START TRANSACTION;
USE `super_api`;
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 1);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 2);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 3);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 4);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 5);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 6);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 7);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 8);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 9);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 10);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 11);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 12);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 13);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 14);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 15);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 16);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 17);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 18);
INSERT INTO `super_api`.`rolePermissions` (`roleId`, `permissionId`) VALUES (1, 19);

COMMIT;


-- -----------------------------------------------------
-- Data for table `super_api`.`users`
-- -----------------------------------------------------
START TRANSACTION;
USE `super_api`;
INSERT INTO `super_api`.`users` (`id`, `username`, `email`, `password`, `confirmed`, `createdAt`, `updatedAt`) VALUES (1, 'admin', 'admin333@yopmail.com', '$2b$10$EMu//Nsypyuj8c5YgKlDv.j42Dc8EpglDY37U4.zbXSUtOGA/Wws.', 0, DEFAULT, DEFAULT);
INSERT INTO `super_api`.`users` (`id`, `username`, `email`, `password`, `confirmed`, `createdAt`, `updatedAt`) VALUES (2, 'edgar', 'edgar333@yopmail.com', '$2b$10$d0jGMqY/Fwzf.Dvucr3AKebZHSuAktzwi7zy4FpGGOYUw4zLARoYe', 0, DEFAULT, DEFAULT);

COMMIT;

